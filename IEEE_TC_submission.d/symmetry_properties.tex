\section{Symmetry of Nested Canalyzing\newline Functions}
\label{sec:ncf_and_symmetry}

\subsection{Overview}
\label{sse:res_overview}
Our first result (Theorem~\ref{thm:ncf_symmetric_variables})
provides a characterization of pairs of variables of an NCF
that are part of the same symmetry group. 
This characterization allows us to give a simple closed form
expression (Theorem~\ref{thm:ncf_r_symmetric}) 
for the symmetry level of an NCF specified using
its default-normalized representation.
%% We also list some corollaries that follow from the
%% characterization.
Next, we show that for any NCF $f$ with $n$ variables,
the two statements ``$f$ is strongly asymmetric" ~and~
``the symmetry level of $f$ is $n$"~ are equivalent 
(Theorem~\ref{thm:ncf_strong_asymmetry}).
We use this result to derive a closed form expression 
for the number of $n$-variable NCFs that are 
also strongly asymmetric (Theorem~\ref{thm:count_strongly_asymmetric}).
Our final result (Proposition~\ref{pro:ncf_symmetric})
identifies all the functions that are symmetric and
canalyzing as well as those that are symmetric and NCFs.

\subsection{Symmetric Pairs of Variables in an NCF: A Characterization
and Its Applications}
\label{sse:ncf_strong_sym}

\begin{theorem}\label{thm:ncf_symmetric_variables}
Two variables of an NCF $f$ are symmetric iff
in the default-normalized representation of $f$,
they occur in the same layer and have the same canalyzing value.
\end{theorem}
\noindent
\textbf{Proof:}~
Suppose that two variables of an NCF $f$ occur in the same layer of a
default-normalized representation, and the lines containing these variables
have the same canalyzing value.  Then in any input assignment, the
values of these two variables can be interchanged, and the evaluation
of the lines in that layer will have the same effect.  Thus, the
variables are symmetric.

For the converse, consider the default-normalized NCF representation of $f$. 
As mentioned earlier, we assume without loss of generality that the
canalyzing variable in line $i$ of $f$ is $x_i$, $1 \leq i \leq n$.
Let  $x_j$ and $x_k$ be two variables that occur in different
layers of $f$, or occur in the same layer, but with different
canalyzing values.  Without loss of generality, 
assume that $j < k$, so that the line for
$x_j$ occurs above the line for $x_k$.
Suppose that line $i$ of $f$, $1 \leq i \leq n$, is 

\smallskip

\hspace*{0.25in}
$x_i : a_i ~\longrightarrow~ b_i$. 

\smallskip

\noindent
Consider the following assignment $\alpha$ = $(c_1, c_2, \ldots,  c_n)$ 
to the variables $x_1$, $x_2$, $\ldots$, $x_n$ of $f$.
\begin{enumerate}
\item For $1 \leq i < j$, set $c_i = \overline{a_i}$. 
\item For $i = j$, set $c_j =a_j$. 
\item For $i = k$, set $c_k =\overline{a_j}$. 
\item For $j < i < k$, and for  $k < i \leq n$, 
if $b_i = b_j$,\\ then set $c_i =  \overline{a_i}$,
else set $c_i =  a_i$.
\end{enumerate}
Note that $f(\alpha) = b_j$, since the variables in all lines above
line $j$ have the complement of their canalyzing value, and variable
$x_j$ has its canalyzing value.

\medskip

Now, let $\alpha'$ be the assignment that is obtained from $\alpha$
by interchanging the values of variables $x_j$ and $x_k$, so that
after the interchange, variable $x_j$ has value $\overline{a_j}$ and
variable $x_k$ has value $a_j$.  We will show that $f(\alpha') =
\overline{b_j}$, so variables $x_j$ and $x_k$ are not symmetric.

In line $k$ of $f$, canalyzing value $a_k$ is either the same or
the complement of canalyzing value $a_j$, and canalyzed value $b_k$
is either the same or the complement of canalyzed value $b_j$,
Thus, there are four possible cases for the form of line $k$.  We
now consider each of the four cases.

\medskip

\noindent
{\bf Case 1:} Line $k$ has the form $x_k : a_j ~\longrightarrow~ b_j$.  

\smallskip

Since line $k$ has
the same canalyzing value and canalyzed value as line $j$, line
$k$ must occur in a lower layer than that of line $j$.  Thus, there
is at least one line between line $j$ and line $k$ for which the
canalyzed value is $\overline{b_j}$.  Let line $q$ be the first
such line.  Note that for all $i$ such that $1 \leq i < q$, the
value of variable $x_i$ in assignment $\alpha'$ does not match the
canalyzing value of line $i$, but the value of variable $x_q$ does
match the canalyzing value of line $q$.  Since canalyzed value
$b_q$ equals $\overline{b_j}$, we have that $f(\alpha') =
\overline{b_j}$.

\medskip

\noindent
{\bf Case 2:} Line $k$ has the form  $x_k : a_j ~\longrightarrow~ \overline{b_j}$.  

\smallskip

Let line $q$ be the first line such that $j < q \leq k$ and the canalyzed
value of line $q$ is $\overline{b_j}$.  Note that $q$ might possibly
equal $k$.  For all $i$ such that $1 \leq i < q$, the value of
variable $x_i$ in assignment $\alpha'$ does not match the canalyzing
value of line $i$, but the value of variable $x_q$ does match the
canalyzing value of line $q$.  Since canalyzed value $b_q$ equals
$\overline{b_j}$, we have that $f(\alpha') = \overline{b_j}$.

\medskip

\noindent
{\bf Case 3:} Line $k$ has the form $x_k : \overline{a_j} ~\longrightarrow~ b_j$.  

\smallskip

Suppose there is a line below line $j$ for which the canalyzed value is
$\overline{b_j}$.  Let $q$ be the first such line.  Note that for
all $i$ such that $1 \leq i < q$, the value of variable $x_i$ in
assignment $\alpha'$ does not match the canalyzing value of line
$i$, but the value of variable $x_q$ does match the canalyzing value
of line $q$.  Since canalyzed value $b_q$ equals $\overline{b_j}$,
we have that $f(\alpha') = \overline{b_j}$.

\smallskip

Now suppose there is no line below line $j$ for which the canalyzed
value is $\overline{b_j}$.  Then lines $j$ and $k$ both occur in
the last layer of $f$.  Thus, for every line $i$, $1 \leq i \leq
n$, the value of variable $x_i$ in assignment $\alpha'$ does not
match the canalyzing value of line $i$.  Consequently, $f(\alpha')
= \overline{b_j}$, the complement of the canalyzed value in the
last layer of $f$.

\medskip

\noindent
{\bf Case 4:} Line $k$ has the form  $x_k : \overline{a_j} ~\longrightarrow~ \overline{b_j}$. 

\smallskip

Suppose there is a line, other than line $k$, below line $j$ for
which the canalyzed value is $\overline{b_j}$.  Let $q$ be the
first such line.  Note that for all $i$ such that $1 \leq i < q$,
the value of variable $x_i$ in assignment $\alpha'$ does not match
the canalyzing value of line $i$, but the value of variable $x_q$
does match the canalyzing value of line $q$.  Since canalyzed value
$b_q$ equals $\overline{b_j}$, we have that $f(\alpha') =
\overline{b_j}$.

Now suppose that line $k$ is the only line below line $j$ for which
the canalyzed value is $\overline{b_j}$.  Since line $j$ has
canalyzed value $b_j$, line $k$ is the only line in its layer.
Since $f$ is default-normalized, the last layer of $f$ contains at least
two lines.  Thus, there is a last layer following the layer containing
line $k$.  The canalyzed value of all the lines in this last layer
is $b_j$.  Thus, for every line $i$, $1 \leq i \leq n$, the value
of variable $x_i$ in assignment $\alpha'$ does not match the
canalyzing value of line $i$.  Consequently, $f(\alpha') =
\overline{b_j}$, the complement of the canalyzed value in the last
layer of $f$.  \QED

\begin{theorem}\label{thm:ncf_r_symmetric}
Suppose the default-normalized representation of a given NCF contains 
$r_1$ layers with only one distinct canalyzing value,
and $r_2$ layers with two distinct canalyzing values.
Then the function is properly $(r_1 + 2 r_2)$-symmetric.
\end{theorem}

\noindent
\textbf{Proof:}~
From Theorem~\ref{thm:ncf_symmetric_variables}, 
any pair of variables occurring in the same layer, 
with the same canalyzing value, are symmetric.
Thus the function is at most $(r_1 + 2 r_2)$-symmetric.
Moreover, any pair of variables from different layers, or with different canalyzing values
are not symmetric, so there are at least $(r_1 + 2 r_2)$ symmetry groups.
\QED

\begin{corollary}\label{cor:ncf_not_rsymm}
For every $n \geq 2$, there is an $n$-variable NCF that is not $n-1$ symmetric.
\end{corollary}

\begin{corollary}\label{cor:ncf_r_symmetric_layers}
(i) An NCF with a default-normalized nested canalyzing representation consisting
of $q$ layers is $2q$-symmetric, and is not $(q-1)$-symmetric.
(ii) An $r$-symmetric NCF has a default-normalized nested canalyzing representation
with at most $r-1$ layers, and has an unnormalized nested canalyzing
representation with at most $r$ layers.  
\end{corollary}

\subsection{Strong Asymmetry and NCFs}
\label{sse:strong_asym_ncf}

The notion of strong asymmetry of Boolean functions was defined 
in Section~\ref{sec:prelim}.
In general, there are functions with $n$ variables that are properly
$n$-symmetric, but not strongly asymmetric \cite{KS-2000}.
We now show that any $n$ variable NCF that is properly $n$-symmetric
is also strongly asymmetric.
As a consequence, we observe that there are NCFs with $n$ variables
that are properly $n$-symmetric.

\begin{theorem}\label{thm:ncf_strong_asymmetry}
An NCF with $n$ variables is strongly asymmetric iff
it is properly $n$-symmetric.
\end{theorem}

\noindent
\textbf{Proof:}~ 
If an NCF is $(n-1)$-symmetric, then consider a permutation that
interchanges two variables from a symmetry group with at least two
members.  The value of the function is invariant under any such
permutation, so the function is not strongly asymmetric.

For the converse, consider an $n$ variable NCF that is properly $n$-symmetric.
Let $f$ be the default-normalized NCF representation for the function.  For
purposes of notational simplicity, without loss of generality,
we assume that the canalyzing
variable in line $i$ of $f$ is $x_i$, $1 \leq i \leq n$.  Let $\pi$
be any permutation of $\{1, 2, \ldots, n\}$ \emph{except} the
identity permutation.  We will construct an assignment $(c_1, c_2,
\ldots,  c_n)$ to the variables of $f$ such that $f(c_1, c_2, \ldots,
c_n)$ $\neq$ $f(c_{\pi(1)}, c_{\pi(2)}, \ldots, c_{\pi(n)})$.

Let $k$ be the smallest index such that $k \neq \pi(k)$.  Since
$\pi$ is a permutation, $k < n$.  Overall, for $1 \leq i < k$,
$\pi(i) = i$,~ $\pi(k) > k$,~ and for $k < i \leq n$,~ $\pi(i) \geq k$.

\smallskip

Suppose that line $i$ of $f$, $1 \leq i \leq n$, is 

\smallskip

\hspace*{0.25in} $x_i : a_i ~\longrightarrow~ b_i$. 

\smallskip

\noindent
Assignment $(c_1, c_2, \ldots,  c_n)$ is constructed as follows.
\begin{enumerate}
\item For $1 \leq i < k$, set $c_i = \overline{a_i}$.  
\item For $i = k$, set $c_k =a_k$. 
\item For $i > k$, let $i' = \pi^{-1}(i)$, so that $\pi(i')
= i$.  Thus, after the permutation of values, variable $x_{i'}$
will have value $c_i$.  If $b_{i'} = b_k$, then set $c_i =
\overline{a_{i'}}$, else set $c_i =  a_{i'}$.
\end{enumerate}
Since $c_k$ matches the canalyzing value of line $k$ of $f$, and
$c_i$ does not match the canalyzing value of any other earlier line
$i$, $1 \leq i < k$, we have that $f(c_1, c_2, \ldots,  c_n) = b_k$.

Now consider $f(c_{\pi(1)}, c_{\pi(2)}, \ldots, c_{\pi(n)})$.  We
first note that for $1 \leq i < k$, $c_{\pi(i)}$ does not match the
canalyzing value of line $i$.

Let $k' = \pi^{-1}(k)$, so that $\pi(k') = k$.  Canalyzing value
$a_{k'}$ is either the same or the complement of $a_k$, and canalyzed
value $b_{k'}$ is either the same or the complement of $b_k$, Thus,
there are four possible cases for the form of line $k'$ of $f$.  We
will show that in each of the four cases, $f(c_{\pi(1)}, c_{\pi(2)},
\ldots, c_{\pi(n)}) = \overline{b_k}$.

\medskip

\noindent
{\bf Case 1:} Line $k'$ has the form  $x_{k'} : a_k ~\longrightarrow~ b_k$.  

\smallskip

Since line $k'$
has the same canalyzing value and canalyzed value as line $k$, and
$f$ is properly $n$-symmetric, line $k'$ must occur in a lower layer
than that of line $k$.  Thus, there is at least one line between
line $k$ and line $k'$ for which the canalyzed value is $\overline{b_k}$.
Let line $q$ be the first such line.  Note that for all $i$ such
that $1 \leq i < q$, $c_{\pi(i)}$ does not match the canalyzing
value of line $i$, but $c_{\pi(q)}$ does match the canalyzing value
of line $q$.  Since canalyzed value $b_q$ equals $\overline{b_k}$,
we have that $f(c_{\pi(1)}, c_{\pi(2)}, \ldots, c_{\pi(n)}) =
\overline{b_k}$.

\medskip

\noindent
{\bf Case 2:} Line $k'$ has the form $x_{k'} : a_k ~\longrightarrow~ \overline{b_k}$.

\smallskip

Let line $q$ be the first line such that $k < q \leq k'$ and
the canalyzed value of line $q$ is $\overline{b_k}$.
Note that for all $i$ such that $1 \leq i < q$, 
$c_{\pi(i)}$ does not match the canalyzing value of line $i$,
so $f(c_{\pi(1)}, c_{\pi(2)}, \ldots, c_{\pi(n)}) = \overline{b_k}$.

\medskip

\noindent
{\bf Case 3:} Line $k'$ has the form $x_{k'} : \overline{a_k} ~\longrightarrow~ b_k$. 

\smallskip

Suppose there is a line below line $k$ for which the canalyzed
value is $\overline{b_k}$.  Let $q$ be the first such line.  Note
that for all $i$ such that $1 \leq i < q$, $c_{\pi(i)}$ does not
match the canalyzing value of line $i$, but $c_{\pi(q)}$ does match
the canalyzing value of line $q$.  Thus, $f(c_{\pi(1)}, c_{\pi(2)},
\ldots, c_{\pi(n)}) = \overline{b_k}$.

Now suppose there is no line below line $k$ for which the canalyzed
value is $\overline{b_k}$.  
Then line $k$ occurs in the last layer of $f$.  
Since $f$ is both default-normalized and properly $n$-symmetric,
this last layer contains exactly two lines.  Thus $k = n-1$ and $k'
= n$.  Note that for all $i$, $c_{\pi(i)}$ does not match the
canalyzing value of line $i$.  Thus, $f(c_{\pi(1)}, c_{\pi(2)},
\ldots, c_{\pi(n)}) = \overline{b_k}$.

\medskip

\noindent
{\bf Case 4:} Line $k'$ has the form $x_{k'} : \overline{a_k} ~\longrightarrow~ 
              \overline{b_k}$. 

\smallskip

Suppose there is a line, other than line $k'$, below line $k$ for
which the canalyzed value is $\overline{b_k}$.  Let $q$ be the
first such line.  Note that for all $i$ such that $1 \leq i < q$,
$c_{\pi(i)}$ does not match the canalyzing value of line $i$, but
$c_{\pi(q)}$ does match the canalyzing value of line $q$.  Thus,
$f(c_{\pi(1)}, c_{\pi(2)}, \ldots, c_{\pi(n)}) = \overline{b_k}$.

Now suppose that line $k'$ is the only line below line $k$ for which
the canalyzed value is $\overline{b_k}$.  Since line $k$ has
canalyzed value $b_k$, line $k'$ is the only line in its layer.
Since $f$ is default-normalized, there is a last layer following the layer
containing line $k'$.  Thus, for all $i$, $c_{\pi(i)}$ does not
match the canalyzing value of line $i$; therefore, 
$f(c_{\pi(1)}, c_{\pi(2)}, \ldots, c_{\pi(n)})$ ~=~ $\overline{b_k}$.  \QED

\medskip

\noindent
We now provide
examples of properly $n$-symmetric $n$-variable NCFs satisfying the
conditions of Theorem \ref{thm:ncf_r_symmetric}.
For each $n > 1$, let $f_n$ be the function of $n$ variables, namely
$x_1, \ldots, x_n$, defined by the following formula:

\smallskip

\hspace*{0.5in} $x_1 \vee (\overline{x}_2 \wedge ( x_3 \vee (\overline{x}_4 \wedge (\cdots ))$

\smallskip

\noindent
For instance,
\begin{align*}
f_6 &~=~  x_1 \vee (\overline{x}_2 \wedge (x_3 \vee (\overline{x}_4 \wedge 
      (x_5 \vee \overline{x}_6)) \\
f_7 &~=~  x_1 \vee (\overline{x}_2 \wedge (x_3 \vee (\overline{x}_4 \wedge (x_5 
          \vee (\overline{x}_6 \wedge  x_7)).
\end{align*}
Function $f_n(x_1, x_2, \ldots, x_n)$ is the NCF corresponding to
the following NCF representation:

\medskip

\noindent
\hspace*{0.25in}
$x_1:~ 1 ~\longrightarrow~ 1$ \\
\hspace*{0.25in}
$x_2:~ 1 ~\longrightarrow~ 0$ \\
\hspace*{0.25in}
$x_3:~ 1 ~\longrightarrow~ 1$ \\
\hspace*{0.75in}
$\vdots$ 

\smallskip

\noindent
If $n$ is odd, the last line is 

\smallskip

\noindent
\hspace*{0.25in}
$x_n:~ 1 ~\longrightarrow~ 1$ 

\smallskip

\noindent
and if $n$ is even, the last line is 

\smallskip

\noindent
\hspace*{0.25in}
$x_n:~ 1 ~\longrightarrow~ 0$. 

\smallskip

\noindent
Note that if $x_i = 0$ for all $i$, $1 \leq i \leq n$, then the
value of $f_n$ is 0 if $n$ is odd and 1 if $n$ is even.  Also, note
that the above representation is unnormalized. To normalize the
representation, the last line would be changed to have canalyzing
value 0, and the same canalyzed value as the preceding line.

\subsection{Number of Strongly Asymmetric NCFs}
\label{sse:number_strongly_asymmetric}

\begin{theorem}\label{thm:count_strongly_asymmetric}
For any $n \geq 2$, the number of Boolean functions with $n$ variables 
that are both strongly asymmetric and NCFs is $n! \, 2^n$.
\end{theorem}

\noindent
\textbf{Proof:}~
Consider a default-normalized representation of a strongly asymmetric NCF $f$.
The representation has $n-1$ layers.
The first $n-2$ layers each contain one line, and the last layer contains two lines.

Consider the canalyzed values in $f$. The canalyzed value in the
first layer can be either 0 or 1.  The canalyzed value in every
other layer is the complement of the canalyzed value in the preceding
layer.  Thus, there are 2 possibilities for the sequence of canalyzed
values in $f$.

The canalyzing variable in each of the first $n-2$ lines (one per
layer) can be any variable that has not yet occurred in a preceding
line.  The last layer contains the remaining two variables.  Thus,
there are $n! / 2$ possibilities for the pattern of variable
occurrences in $f$.

For each of the $n$ variables, the canalyzing value for the line
containing that variable can be either 0 or 1.  Thus, there are
$2^n$ possibilities for canalyzing values.  

Hence, the number of Boolean functions with $n$ variables that
are both strongly asymmetric and NCFs is equal to \\ 
$2 \times (n!/2) \times 2^n$ ~=~ $n!\,2^n$.  \QED


\subsection{Symmetric Canalyzing and Nested Canalyzing Functions}
\label{sse:sym_and_cf_ncf}

\begin{proposition}\label{pro:ncf_symmetric}
(i) The only symmetric canalyzing functions are OR, AND, NOR, NAND, 
the constant function 0 and the constant function 1.
(ii) The only symmetric NCFs are OR, AND, NOR and NAND.
\end{proposition}
%%\medskip
\noindent
\textbf{Proof:}~

\smallskip

\noindent
\textbf{Part (i):}~
Suppose symmetric function $f$ is also a canalyzing function. 
Then there is a variable $x$, and values $a$ and $b$ 
such that whenever $x = a$, function $f$ has value $b$.  
Since $f$ is symmetric, $f$  has
value $b$ whenever any of its variables has value $a$.  
Thus, if at least one of its variables has value $a$, then $f$ has value $b$.  
If $f$ has value $\overline{b}$ when none of its variables has
value $a$, the four possible combinations of values for $a$ and $b$
correspond to the four functions OR, AND, NOR, and NAND.  If $f$
has value $b$ when none of its variables has value $a$, then $f$
is the constant function $b$.

\smallskip

\noindent
\textbf{Part (ii):}~
Suppose that symmetric function $f$ is also an NCF.  
Since constant functions are not NCFs,
$f$ has value $\overline{b}$ when none of its variables has value $a$.
The four possible combinations of values for $a$ and $b$ correspond
to the four functions OR, AND, NOR and NAND, each of which is an
NCF.  \QED








